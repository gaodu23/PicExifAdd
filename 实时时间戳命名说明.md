# GPS照片批量添加工具 - 实时时间戳命名功能说明

## 更新内容

### 文件命名策略
- **之前**: 使用批处理开始时的固定时间戳 + 4位序号
- **现在**: 每张照片使用其实际处理时的实时时间戳 + 2位序号

### 命名格式
```
YYMMDDHHMMSSXX.jpg
```

**格式说明：**
- `YY` - 年份后两位 (25 = 2025年)
- `MM` - 月份 (01-12)
- `DD` - 日期 (01-31)  
- `HH` - 小时 (00-23)
- `MM` - 分钟 (00-59)
- `SS` - 秒钟 (00-59)
- `XX` - 2位序号 (01, 02, 03...)

### 示例
```
处理时间: 2025年9月6日 14:25:30
第1张照片: 25090614253001.jpg
第2张照片: 25090614253102.jpg  (1秒后处理)
第3张照片: 25090614253203.jpg  (2秒后处理)
```

## 主要特点

### ✅ 优势
1. **实时性**: 每张照片的文件名反映其实际处理时间
2. **唯一性**: 时间戳精确到秒，确保文件名不重复
3. **可读性**: 从文件名即可知道照片的处理时间
4. **简洁性**: 2位序号比4位更简洁，适合大多数使用场景
5. **时间追踪**: 可以从文件名分析批处理的时间分布

### 📋 使用场景
- 需要追踪每张照片的具体处理时间
- 批量处理中需要时间戳作为唯一标识
- 需要按处理时间顺序管理照片文件
- 质量控制和审计需要准确的处理时间记录

## 技术实现

### 关键代码改动
```python
# 为每个照片生成处理时的实时时间戳
current_timestamp = time.strftime("%y%m%d%H%M%S")
sequence = str(row_num).zfill(2)  # 2位序号
new_filename = f"{current_timestamp}{sequence}.jpg"
```

### 处理流程
1. 读取CSV文件中的GPS数据
2. 逐张处理照片时：
   - 生成当前时间的时间戳
   - 分配2位序号
   - 合成新文件名
   - 复制照片到输出目录
   - 写入GPS EXIF数据

### 性能考虑
- 每张照片的处理时间间隔通常为几秒钟
- 时间戳精确到秒，足以保证唯一性
- 2位序号支持最多99张照片的并发处理

## 兼容性

### CSV格式支持
```csv
纬度,经度,海拔,文件名
39.123456,116.789012,100.5,IMG_001.jpg
39.123457,116.789013,101.0,IMG_002.jpg
```

### 文件格式
- 输入: JPG/JPEG照片文件
- 输出: JPG照片文件（带GPS EXIF数据）
- 相机参数: OPT格式文件

## 使用说明

1. 选择相机参数文件 (.opt)
2. 选择CSV数据文件（格式：纬度,经度,海拔,文件名）
3. 选择原始图片文件夹
4. 选择导出位置
5. 点击"预览文件"检查数据匹配
6. 点击"开始处理"进行批量处理

## 日志输出示例

```
==================================================
开始处理图片...
第1行: 处理 IMG_001.jpg (39.123456, 116.789012, 100.5m)
     原文件名: IMG_001.jpg -> 新文件名: 25090614253001.jpg
  ✅ 成功 (保存为: 25090614253001.jpg)
第2行: 处理 IMG_002.jpg (39.123457, 116.789013, 101.0m)
     原文件名: IMG_002.jpg -> 新文件名: 25090614253102.jpg
  ✅ 成功 (保存为: 25090614253102.jpg)
==================================================
处理完成: 成功=2, 失败=0
输出文件夹: D:\Output
文件命名格式: YYMMDDHHMMSSXX.jpg (XX为2位序号)
```

## 版本信息
- 更新版本: V1.2
- 更新日期: 2025年9月6日
- 主要改进: 实时时间戳命名功能
